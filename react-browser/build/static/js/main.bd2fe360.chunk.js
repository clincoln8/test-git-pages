(this["webpackJsonpreact-browser"]=this["webpackJsonpreact-browser"]||[]).push([[0],{11:function(e,t,n){e.exports=n(19)},16:function(e,t,n){},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(10),c=n.n(o),l=(n(16),n(1)),s=n(2),i=n(4),u=n(3),d=(n(17),function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleSearch=function(e){13===e.keyCode&&(window.location.hash="#dcid="+e.target.value)},e}return Object(s.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("input",{type:"search",onKeyUp:this.handleSearch,placeholder:"Search for a dcid..."}),a.a.createElement("button",{onClick:function(){return window.location.hash=""}},"Return Home"))}}]),n}(r.Component)),f=n(7),h=n(5),p=n.n(h),v=n(6),m=n(8),b=function(){function e(t,n,r,a){Object(l.a)(this,e),this.src=t,this.property=n,this.provenance=a,this.target=r,this.nextAssertion=t.assertions,t.assertions=this,r instanceof Object&&(this.invNextAssertion=r.invAssertions,r.invAssertions=this)}return Object(s.a)(e,null,[{key:"addAssertion",value:function(t,n,r,a){new e(t,n,r,a)}},{key:"createAssertionFromValueObj",value:function(t,n,r){var a;"dcid"in r?a=O.getNode(r.dcid,!0):"value"in r?a=r.value:console.log("Node has no 'dcid' or 'value' prop: "+r),e.addAssertion(t,n,a,r.provenanceId)}},{key:"createInvAssertionFromValueObj",value:function(t,n,r){var a;"dcid"in r?a=O.getNode(r.dcid,!0):console.log("Node has no 'dcid' for inverse: "+r),console.log("src: "+a.dcid+", prop: "+n+", target: "+t.dcid+", prov: "+r.provenanceId),e.addAssertion(a,n,t,r.provenanceId)}}]),e}(),E="https://api.datacommons.org",j=function(){function e(t){Object(l.a)(this,e),this.dcid=t,this.alreadyFetched=!1}return Object(s.a)(e,[{key:"fetchRemoteData",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this).alreadyFetched){e.next=5;break}return e.next=4,y(t.dcid).then(function(){var e=Object(m.a)(p.a.mark((function e(n){var r,a,o,c,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(v.a)(n.outLabels),e.prev=1,o=p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.value,e.next=3,g(t.dcid,n,!0).then((function(e){if(e){var r,a=Object(v.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;b.createAssertionFromValueObj(t,n,o)}}catch(c){a.e(c)}finally{a.f()}}else console.log("ERROR: could not find value for node: "+t.dcid+", label: "+n)}));case 3:case"end":return e.stop()}}),e)})),r.s();case 4:if((a=r.n()).done){e.next=8;break}return e.delegateYield(o(),"t0",6);case 6:e.next=4;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),r.e(e.t1);case 13:return e.prev=13,r.f(),e.finish(13);case 16:c=Object(v.a)(n.inLabels),e.prev=17,s=p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.value,console.log(n),e.next=4,g(t.dcid,n,!1).then((function(e){var r,a=Object(v.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;b.createInvAssertionFromValueObj(t,n,o)}}catch(c){a.e(c)}finally{a.f()}}));case 4:case"end":return e.stop()}}),e)})),c.s();case 20:if((l=c.n()).done){e.next=24;break}return e.delegateYield(s(),"t2",22);case 22:e.next=20;break;case 24:e.next=29;break;case 26:e.prev=26,e.t3=e.catch(17),c.e(e.t3);case 29:return e.prev=29,c.f(),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[1,10,13,16],[17,26,29,32]])})));return function(t){return e.apply(this,arguments)}}());case 4:t.alreadyFetched=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"getNode",value:function(t,n){var r=e.nodeHash[t];if(r)return r;if(n){var a=new e(t);return e.nodeHash[t]=a,a}return null}},{key:"isNode",value:function(t){return t instanceof e}}]),e}();function y(e){var t=function(e){return E+"/node/property-labels?dcids="+e}(e);return fetch(t).then((function(e){return e.json()})).then((function(t){return JSON.parse(t.payload)[e]}))}function g(e,t,n){var r=function(e,t,n){var r=E+"/node/property-values?dcids="+e+"&property="+t+"&direction=";return r+=n?"out":"in",r+="&limit=500"}(e,t,n);return fetch(r).then((function(e){return e.json()})).then((function(t){return JSON.parse(t.payload)[e]})).then((function(e){return console.log("url: "+r+", values: "+e),n?e.out:e.in}))}j.nodeHash={},j.subjNodes={};var O=j,k=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"readFile",value:function(t){var n=new FileReader;return n.readAsText(t),new Promise((function(t,r){n.addEventListener("loadend",(function(r){console.log(r),console.log(n.result);var a,o,c=n.result.split("\n"),l=Object(v.a)(c);try{for(l.s();!(o=l.n()).done;){var s=o.value;console.log(s),a=e.parseLine(s,a),console.log(a)}}catch(i){l.e(i)}finally{l.f()}t(O.subjNodes)})),n.addEventListener("error",r)}))}},{key:"shouldReadLine",value:function(e){return!e.startsWith("#")&&!e.startsWith("//")&&0!==e.length}},{key:"readPropLabel",value:function(e){var t,n=e.split(":");return n.length<2?(console.log("Line does not contain colon: "+e),t):t=n[0]}},{key:"readNodeValue",value:function(e){var t;if(2===e.split(":").length&&"dcid"===e.split(":")[0]){var n=e.split(":")[1];return t=O.getNode(n,!0)}return console.log("Incorrect number of colons in node declaration: "+e),t}},{key:"readPropValues",value:function(t){var n,r=t.split(":");if(r.length<2||""===r[1])return console.log("Line does not contain value: "+t),n;var a=r.slice(1).join(":").split(",");return n=[],a.forEach((function(t){var r=t.trim();r.includes(":")?(r=e.readNodeValue(r))&&n.push(r):n.push(r.replace(/"/g,""))})),n}},{key:"readDCID",value:function(e){var t=e.split(":");if(3===t.length)return t[t.length-1].trim();console.log("Node declaration, incorrect num of colons: "+e)}},{key:"parseLine",value:function(t,n){var r;if(n&&(r=n),t=t.trim(),e.shouldReadLine(t)){var a=e.readPropLabel(t);if(!a)return r;if("Node"===a){var o=e.readDCID(t);return o?(r=O.getNode(o,!0),o in O.subjNodes||(O.subjNodes[o]=r),r):r}var c=e.readPropValues(t);if(!c)return r;c.forEach((function(e){return b.addAssertion(r,a,e,"local mcf")}))}return r}}]),e}(),w=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).onSubmitPress=function(){var e=Object(f.a)(r);k.readFile(r.state.fileList[0]).then((function(t){e.props.setSubjNodes(Object.keys(t))}))},r.onClearPress=function(){Object(f.a)(r).setState({localDCIDList:[]}),localStorage.clear()},r.render=function(){return a.a.createElement("div",null,a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement(d,null),a.a.createElement("h3",null,"Upload an MCF file to preview it in Data Commons."),a.a.createElement("div",null,a.a.createElement("input",{id:"file-select",onChange:function(e){return r.state.fileList=e.target.files},type:"file",name:"UploadFile",accept:".mcf",required:!0}),a.a.createElement("br",null),a.a.createElement("button",{id:"submitFile",onClick:r.onSubmitPress},"Submit"),a.a.createElement("br",null),a.a.createElement("button",{id:"clearFile",onClick:r.onClearPress},"Clear")),a.a.createElement("ul",null,r.state.localDCIDList.map((function(e){return a.a.createElement("li",{key:e,onClick:function(){return window.location.hash="#dcid="+e}},e)}))))))},r.state={localDCIDList:r.props.subjNodes,fileList:null},r}return n}(r.Component);function N(e){return O.isNode(e)?a.a.createElement("td",{onClick:function(){return window.location.hash="#dcid="+e.dcid}},e.dcid):a.a.createElement("td",null,e)}var C=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).render=function(){return a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"property"),a.a.createElement("th",null,"target"),a.a.createElement("th",null,"provenance"))),a.a.createElement("tbody",null,e.props.asserts.map((function(e,t){return a.a.createElement("tr",{key:e.property+t},a.a.createElement("td",null,e.property),N(e.target),a.a.createElement("td",null,e.provenance))}))))},e}return n}(r.Component),A=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).render=function(){return a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"source"),a.a.createElement("th",null,"property"),a.a.createElement("th",null,"provenance"))),a.a.createElement("tbody",null,e.props.invAsserts.map((function(e,t){return a.a.createElement("tr",{key:e.property+t},N(e.src),a.a.createElement("td",null,e.property),a.a.createElement("td",null,e.provenance))}))))},e}return n}(r.Component),D=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).render=function(){return a.a.createElement("div",null,a.a.createElement(d,null),a.a.createElement("h1",null,"Display node: ",r.state.dcid),a.a.createElement("h3",null,"Assertions"),a.a.createElement("p",null,a.a.createElement("u",null,"source: ",r.state.dcid)),a.a.createElement(C,{asserts:r.state.asserts}),a.a.createElement("br",null),a.a.createElement("h3",null,"Inverse Assertions"),a.a.createElement("p",null,a.a.createElement("u",null,"target: ",r.state.dcid)),a.a.createElement(A,{invAsserts:r.state.invAsserts}))},r.state={dcid:r.props.dcid,asserts:[],invAsserts:[]},console.log("render "+r.props.dcid),r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=O.getNode(this.state.dcid,!0);t.fetchRemoteData(t).then((function(){for(var n=t.assertions,r=[],a=[];n;)r.push(n),n=n.nextAssertion;var o=t.invAssertions;for(console.log(t);o;)a.push(o),o=o.invNextAssertion,console.log(a);e.setState({asserts:r,invAsserts:a})}))}}]),n}(r.Component),x=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).setSubjNodes=function(e){r.setState({subjNodes:e})},r.render=function(){return window.location.href.includes("dcid")?r.state.curDCID?a.a.createElement(D,{key:r.state.curDCID,dcid:r.state.curDCID}):a.a.createElement("div",null,a.a.createElement(d,null),a.a.createElement("h2",null,"Requested url could not be found")):a.a.createElement(w,{setSubjNodes:r.setSubjNodes,key:r.state.subjNodes,subjNodes:r.state.subjNodes})},r.state={subjNodes:[],curDCID:null},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("hashchange",(function(){console.log("in listener"+window.location.hash);var t=new URLSearchParams(window.location.hash.split("#")[1]).get("dcid");t?e.setState({curDCID:t}):e.setState({curDCID:null})}),!1)}}]),n}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.log("render from index.js"),c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.bd2fe360.chunk.js.map